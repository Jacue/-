<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE en-export SYSTEM "http://xml.evernote.com/pub/evernote-export3.dtd">
<en-export export-date="20180317T102657Z" application="Evernote" version="Evernote Mac 7.0.2 (456267)">
<note><title>Masonry源码分析</title><content><![CDATA[<!DOCTYPE en-note SYSTEM "http://xml.evernote.com/pub/enml2.dtd"><en-note><div>// 添加约束</div><div>+(instancetype)constraintWithItem:(id)view1 attribute:(NSLayoutAttribute)attr1 relatedBy:(NSLayoutRelation)relation toItem:(nullable id)view2 attribute:(NSLayoutAttribute)attr2 multiplier:(CGFloat)multiplier constant:(CGFloat)c;</div><div><br /></div><div>view1：设置约束的对象（视图）</div><div>attr1：设置相应的约束属性</div><div>relation：参照关系（=，&gt;=，&lt;=）</div><div>view2：参照物（视图）</div><div>attr2：参照物的相应约束属性</div><div>multiplier：倍数</div><div>c：偏移量</div><div><br /></div><div>从Masonry的使用中，我们看看库中各个类的分工：</div><div><br /></div><div>[blackView mas_makeConstraints:^(MASConstraintMaker *make) {</div><div>        make.left.top.mas_equalTo(self.view).offset(80);</div><div>        make.size.mas_equalTo(CGSizeMake(50, 50));</div><div>}];</div><div><br /></div><div>mas_makeConstraints中生成MASConstraintMaker对象，然后由开发人员在block中设置相应约束，再通过maker的install方法以constraintWithItem的方式添加约束。</div><div><br /></div><div>MASConstraintMaker对外暴露各种可设置的约束属性（left、right、size等），内部持有view（对应上面的view1）和constraints（添加到view上的约束）</div><div><br /></div><div>block中是通过链式语法来设置相应约束的，值得一提的是，第一个点语法返回的是MASViewConstraint，第二个点语法返回的是MASCompositeConstraint（持有元素为MASViewConstraint的数组childConstraints），二者都继承于MASConstraint。每次点语法都会更新MASConstraintMaker的constraints属性，constraints的元素个数为block中的链式语法数量。</div><div><br /></div><div>MASConstraint对外暴露各种可设置的约束属性（left、right、size等）以及与参照物的比对方法mas_equalTo、mas_offset等</div><div><br /></div><div>MASViewConstraint继承于MASConstraint，包含单个约束的具体信息。其中的各属性分别对应系统api中参数如下：</div><div>（public）</div><div>firstViewAttribute （MASViewAttribute） -&gt; attr1</div><div>secondViewAttribute （MASViewAttribute）-&gt; attr2</div><div>（private）</div><div>installedView -&gt; view1和view2的父视图</div><div>layoutRelation -&gt; relation</div><div>layoutConstant -&gt; c</div><div>layoutMultiplier -&gt; multiplier</div><div>layoutPriority 优先级</div><div>layoutConstraint 由以上属性生成的约束</div><div><br /></div><div>其中，MASViewAttribute持有单个约束的信息，view（如果不是视图，为空），item（视图），layoutAttribute（单个约束）</div><div><br /></div><div>链式语法中，mas_equalTo之前为设置firstViewAttribute，mas_equalTo之后设置secondViewAttribute。</div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><span style="font-size: 12px; color: rgb(69, 69, 69); font-family: Menlo; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">
</span></div></en-note>]]></content><created>20180311T015122Z</created><updated>20180317T101856Z</updated><note-attributes><author>jacue.soul@gmail.com</author><source>desktop.mac</source><reminder-order>0</reminder-order></note-attributes></note>
</en-export>
